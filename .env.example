# =============================================================================
# LIVEKIT-HENRYK CONFIGURATION
# =============================================================================
# This file contains all environment variables needed to run the xAI Grok
# voice agent with recording, transcription, and webhook capabilities.
#
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# =============================================================================


# =============================================================================
# LIVEKIT CLOUD (Required)
# =============================================================================
# Get these from: https://cloud.livekit.io → Your Project → Settings → Keys
#
# LIVEKIT_URL: WebSocket URL for agent connection
# LIVEKIT_PUBLIC_URL: Public URL for Meet UI (usually same as LIVEKIT_URL)
# LIVEKIT_API_KEY: API key from LiveKit Cloud Console
# LIVEKIT_API_SECRET: API secret from LiveKit Cloud Console

LIVEKIT_URL=wss://your-project.livekit.cloud
LIVEKIT_PUBLIC_URL=wss://your-project.livekit.cloud
LIVEKIT_API_KEY=your_api_key
LIVEKIT_API_SECRET=your_api_secret

# LiveKit Meet URL for browser testing (default: https://meet.livekit.io)
LIVEKIT_MEET_URL=https://meet.livekit.io

# Agent name - MUST match your LiveKit dispatch rule
# Configure dispatch rules in: LiveKit Cloud Console → Settings → Dispatch
LIVEKIT_AGENT_NAME=test_agent


# =============================================================================
# XAI GROK VOICE API (Required)
# =============================================================================
# Get your API key from: https://x.ai/api
# This enables speech-to-speech conversations with Grok Voice

XAI_API_KEY=your_xai_api_key


# =============================================================================
# AGENT SETTINGS (Optional)
# =============================================================================
# AGENT_TIMEZONE: IANA timezone for time references in conversations
#   Examples: UTC, America/New_York, Europe/London, Asia/Tokyo
#   Full list: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones

AGENT_TIMEZONE=UTC

# EXA_API_KEY: For web search capability (optional)
# Get from: https://exa.ai/
EXA_API_KEY=


# =============================================================================
# PHONE CALLS - SIP TRUNK (Required for outbound dialing)
# =============================================================================
# To make real phone calls, you need:
#
# 1. TWILIO ACCOUNT
#    - Sign up at: https://twilio.com
#    - Purchase a phone number (for caller ID)
#    - Create a SIP trunk with credentials
#
# 2. LIVEKIT SIP TRUNK
#    - Go to: LiveKit Cloud Console → Settings → SIP
#    - Add your Twilio trunk credentials
#    - Copy the trunk ID (starts with ST_)
#
# LIVEKIT_SIP_TRUNK_ID: SIP trunk ID from LiveKit Cloud Console
# TWILIO_PHONE_NUMBER: Your Twilio number in E.164 format (+1234567890)

LIVEKIT_SIP_TRUNK_ID=ST_xxxxxxxxxxxx
TWILIO_PHONE_NUMBER=+1234567890


# =============================================================================
# RECORDING - SUPABASE CLOUD STORAGE (Required for recording)
# =============================================================================
# Recordings are stored in Supabase Cloud Storage (S3-compatible).
# This enables dual-channel recording: Agent=Left channel, Human=Right channel
#
# SETUP INSTRUCTIONS:
# 1. Create Supabase project: https://supabase.com/dashboard
# 2. Go to: Storage → New bucket → Name it "Recordings"
# 3. Go to: Settings → Storage → S3 Connection
# 4. Generate new access key and copy credentials
#
# STORAGE_ACCESS_KEY: S3 access key from Supabase
# STORAGE_SECRET: S3 secret key from Supabase
# STORAGE_BUCKET: Bucket name (default: Recordings)
# STORAGE_ENDPOINT: S3 endpoint URL from Supabase
# STORAGE_REGION: AWS region (usually eu-north-1 for Supabase)

STORAGE_ACCESS_KEY=your_supabase_s3_access_key
STORAGE_SECRET=your_supabase_s3_secret_key
STORAGE_BUCKET=Recordings
STORAGE_ENDPOINT=https://your-project-id.storage.supabase.co/storage/v1/s3
STORAGE_REGION=eu-north-1


# =============================================================================
# TRANSCRIPTION - ASSEMBLYAI (Required for transcription)
# =============================================================================
# AssemblyAI transcribes both audio channels after the call ends.
# The transcripts are merged and formatted as: AI: ... Human: ...
#
# Get your API key from: https://www.assemblyai.com/dashboard
#
# ASSEMBLYAI_API_KEY: Your AssemblyAI API key

ASSEMBLYAI_API_KEY=your_assemblyai_api_key


# =============================================================================
# POST-CALL WEBHOOK - N8N (Required for webhook notifications)
# =============================================================================
# After transcription completes, a webhook is sent to n8n with:
# - room_name: LiveKit room name
# - phone_number: Called number (E.164 format)
# - first_name, last_name: Caller info
# - recording_url: Public URL to the recording
# - transcript: Formatted text (AI: ... Human: ...)
# - transcript_structured: Array of segments with timestamps
#
# SETUP INSTRUCTIONS:
# 1. Create n8n webhook node
# 2. Set method to POST
# 3. Copy the webhook URL
#
# POST_CALL_WEBHOOK_URL: Your n8n webhook URL

POST_CALL_WEBHOOK_URL=https://your-n8n-instance/webhook/your-webhook-id


# =============================================================================
# LIVEKIT WEBHOOK CONFIGURATION (Manual Setup Required)
# =============================================================================
# LiveKit sends webhooks when recordings complete (egress_ended event).
# You must configure this in LiveKit Cloud Console:
#
# 1. Go to: https://cloud.livekit.io → Your Project → Settings → Webhooks
# 2. Add webhook URL: https://livekit-control.phoentixai.net/livekit-henryk/webhook
# 3. Select events: egress_ended
# 4. Save
#
# This enables automatic transcription when calls end.
# =============================================================================
